<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Portal Interno K-Corp | Corporação do Cálice</title>
        <link rel="stylesheet" href="css/home.css">
    </head>
    <body>
        <header>
            <div class="container">
                <div class="header-top">
                    <div class="logo">
                        <div class="logo-img">K</div>
                        <div class="logo-text">
                            <h1>K-Corp Internal Network</h1>
                            <p>Corporação do Cálice - Departamento de Pesquisa e
                                Desenvolvimento</p>
                        </div>
                    </div>
                    <div class="user-info" id="user-profile-btn">
                        <div class="user-avatar" id="user-avatar">DL</div>
                        <div class="user-details">
                            <div class="user-name"
                                id="user-name">Carregando...</div>
                            <div class="user-role"
                                id="user-role">Carregando...</div>
                        </div>
                    </div>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active"
                                data-tab="home">Feed Corporativo</a></li>
                        <li><a href="#" class="nav-link"
                                data-tab="lore">Arquivos K-Corp</a></li>
                        <li><a href="#" class="nav-link" data-tab="staff">Rede
                                de Colaboradores</a></li>
                        <li><a href="#" class="nav-link"
                                data-tab="profile">Perfil</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <main class="container">
            <!-- Página Inicial - Feed Corporativo -->
            <div id="home" class="tab-content active">
                <h2 class="page-title">Feed Corporativo</h2>

                <div class="card post-form">
                    <h3 class="card-title">Nova Publicação</h3>
                    <form id="new-post-form">
                        <div class="form-group">
                            <label for="post-title">Título</label>
                            <input type="text" id="post-title"
                                class="form-control"
                                placeholder="Digite o título da publicação">
                        </div>
                        <div class="form-group">
                            <label for="post-content">Conteúdo</label>
                            <textarea id="post-content" class="form-control"
                                placeholder="Compartilhe notícias, descobertas ou atualizações..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="post-image">Imagem (URL)</label>
                            <input type="text" id="post-image"
                                class="form-control"
                                placeholder="Cole a URL de uma imagem">
                        </div>
                        <button type="submit" class="btn">Publicar</button>
                    </form>
                </div>

                <div class="feed">
                    <!-- Post 1 -->
                    <div class="card post">
                        <div class="card-header">
                            <div class="card-title">Novo Protocolo de Campo
                                Aprovado</div>
                            <div class="card-date">15/03/2023 - 14:22</div>
                        </div>
                        <div class="post-author">
                            <div class="author-avatar">JL</div>
                            <div class="author-name">José Lin</div>
                        </div>
                        <div class="post-content">
                            <p>Após extensivos testes, o novo protocolo de campo
                                para aplicação do Remédio de Cura Instantânea em
                                condições de combate foi aprovado. Os resultados
                                mostram uma eficácia 37% maior na regeneração
                                tecidual quando aplicado com a nova seringa de
                                alta pressão.</p>
                            <p>Estou disponível para treinar equipes que forem
                                designadas para zonas de conflito. Contatem-me
                                através do portal interno.</p>
                        </div>
                        <div class="post-actions">
                            <span>12 Comentários</span>
                            <span>28 Visualizações</span>
                        </div>
                    </div>

                    <!-- Post 2 -->
                    <div class="card post">
                        <div class="card-header">
                            <div class="card-title">Atualização de Segurança -
                                Setor 4</div>
                            <div class="card-date">14/03/2023 - 09:45</div>
                        </div>
                        <div class="post-author">
                            <div class="author-avatar">AD</div>
                            <div class="author-name">Ana Dimitri</div>
                        </div>
                        <div class="post-content">
                            <p>Atenção todos os funcionários: O Setor 4 estará
                                em lockdown temporário a partir das 18h hoje
                                para procedimentos de descontaminação de nível
                                3. O acesso será restrito até segunda ordem.</p>
                            <p>Lembrem-se de seguir todos os protocolos de
                                biossegurança ao manusear amostras da cepa
                                K-7b.</p>
                        </div>
                        <div class="post-actions">
                            <span>7 Comentários</span>
                            <span>45 Visualizações</span>
                        </div>
                    </div>

                    <!-- Post 3 -->
                    <div class="card post">
                        <div class="card-header">
                            <div class="card-title">Relatório de Campo: Distrito
                                12</div>
                            <div class="card-date">12/03/2023 - 16:30</div>
                        </div>
                        <div class="post-author">
                            <div class="author-avatar">JL</div>
                            <div class="author-name">José Lin</div>
                        </div>
                        <div class="post-content">
                            <p>Concluí a análise preliminar dos efeitos
                                colaterais observados nos sujeitos do Distrito
                                12. Os dados sugerem uma correlação entre a
                                aplicação prolongada do Remédio K e o
                                desenvolvimento de resistência à dor em 68% dos
                                casos.</p>
                            <p>Recomendo a suspensão temporária do programa de
                                testes no Distrito 12 até que possamos isolar a
                                variável responsável.</p>
                            <img
                                src="https://i.pinimg.com/1200x/fd/ea/85/fdea85daf87811082819cd016b6e3527.jpg"
                                alt="Gráfico de dados" class="post-image">
                        </div>
                        <div class="post-actions">
                            <span>23 Comentários</span>
                            <span>89 Visualizações</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Página de Lore -->
            <div id="lore" class="tab-content">
                <h2 class="page-title">Arquivos K-Corp</h2>

                <div class="card">
                    <h3 class="card-title">História Corporativa</h3>
                    <p>A K-Corp, formalmente conhecida como Corporação do
                        Cálice, emergiu como uma das entidades mais
                        influentes na Cidade através do desenvolvimento e
                        comercialização de sua tecnologia de cura
                        revolucionária. Fundada no Distrito 9 por um
                        coletivo de bio-alquimistas e engenheiros genéticos,
                        a corporação rapidamente expandiu sua influência
                        através do monopólio sobre o
                        "Remédio de Cura Instantânea".</p>
                    <p>Nossos princípios fundamentais sempre foram: inovação
                        sem limites, eficácia comprovada e lealdade
                        corporativa acima de tudo.</p>
                </div>

                <div class="card">
                    <h3 class="card-title">Tecnologia de Cura K-Corp</h3>
                    <p>O segredo por trás do nosso Remédio de Cura
                        Instantânea reside em uma espécie única de inseto
                        bio-engenheirado, capaz de reverter o estado de
                        qualquer matéria orgânica para um estado anterior
                        saudável. Este processo, conhecido como
                        "Regressão Dirigida", representa o ápice da
                        biotecnologia moderna.</p>

                    <div class="lore-grid">
                        <div class="lore-item">
                            <h3>Mecanismo de Ação</h3>
                            <p>Os insetos K-Corp identificam e "memorizam" o
                                estado saudável do tecido, revertendo danos
                                de forma precisa e instantânea.</p>
                        </div>
                        <div class="lore-item">
                            <h3>Aplicações</h3>
                            <p>Além da cura de ferimentos, nossa tecnologia
                                tem aplicações em regeneração tecidual,
                                antienvelhecimento e aprimoramento
                                físico.</p>
                        </div>
                        <div class="lore-item">
                            <h3>Pesquisa e Desenvolvimento</h3>
                            <p>Continuamos explorando novas aplicações para
                                nossa tecnologia, incluindo integração
                                cibernética e manipulação genética.</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Estrutura Organizacional</h3>
                    <p>A K-Corp opera através de um sistema de departamentos
                        especializados:</p>
                    <ul>
                        <li><strong>Pesquisa e Desenvolvimento:</strong>
                            Inovação em tecnologia de cura e novos
                            produtos</li>
                        <li><strong>Produção em Massa:</strong> Fabricação e
                            distribuição do Remédio K</li>
                        <li><strong>Segurança Corporativa:</strong> Proteção
                            de ativos e propriedade intelectual</li>
                        <li><strong>Relações Públicas:</strong> Manutenção
                            da imagem corporativa e relações com outras
                            entidades</li>
                        <li><strong>Operações de Campo:</strong>
                            Implementação de protocolos em situações
                            reais</li>
                    </ul>
                </div>
            </div>

            <!-- Página de Funcionários -->
            <div id="staff" class="tab-content">
                <h2 class="page-title">Rede de Colaboradores</h2>

                <div class="card">
                    <h3 class="card-title">Fórum de Colaboração</h3>
                    <p>Utilize este espaço para agendar consultas, solicitar
                        equipamentos, divulgar projetos ou coordenar
                        pesquisas com outros membros da K-Corp.</p>

                    <div class="form-group">
                        <label for="forum-topic">Tópico</label>
                        <input type="text" id="forum-topic"
                            class="form-control"
                            placeholder="Digite o tópico da discussão">
                    </div>
                    <div class="form-group">
                        <label for="forum-content">Mensagem</label>
                        <textarea id="forum-content" class="form-control"
                            placeholder="Digite sua mensagem..."></textarea>
                    </div>
                    <button class="btn">Postar no Fórum</button>
                </div>

                <div class="staff-grid">
                    <!-- Dr. Lin -->
                    <div class="card staff-card">
                        <div class="staff-avatar">JL</div>
                        <div class="staff-info">
                            <div class="staff-name">José Lin</div>
                            <div class="staff-role">Médico de Campo Sênior |
                                Pesquisador Nível 1</div>
                            <div class="staff-bio">Especialista em aplicação
                                de campo do Remédio K e desenvolvimento de
                                protocolos de emergência. Responsável pelo
                                programa de testes no Distrito 12.</div>
                            <div class="staff-contact">Contato: jl@kcorp.net
                                | Ext: 777</div>
                        </div>
                    </div>

                    <!-- Kuuhaku -->
                    <div class="card staff-card">
                        <div class="staff-avatar">KK</div>
                        <div class="staff-info">
                            <div class="staff-name">Kuuhaku</div>
                            <div class="staff-role">Agente de Campo Especial
                                | Nível 1</div>
                            <div class="staff-bio">Especialista em operações
                                táticas e reconhecimento. Responsável por
                                missões de alto risco em zonas de
                                conflito.</div>
                            <div class="staff-contact">Contato:
                                kuuhaku@kcorp.net | Ext: 5280</div>
                        </div>
                    </div>

                    <!-- Scar -->
                    <div class="card staff-card">
                        <div class="staff-avatar">SC</div>
                        <div class="staff-info">
                            <div class="staff-name">Scar</div>
                            <div class="staff-role">Especialista em
                                Segurança | Nível 1</div>
                            <div class="staff-bio">Responsável pela
                                segurança de instalações críticas e proteção
                                de pessoal em missões de campo.</div>
                            <div class="staff-contact">Contato:
                                scar@kcorp.net | Ext: 6194</div>
                        </div>
                    </div>

                    <!-- Hanssen -->
                    <div class="card staff-card">
                        <div class="staff-avatar">HS</div>
                        <div class="staff-info">
                            <div class="staff-name">Hanssen</div>
                            <div class="staff-role">Pesquisador Sênior |
                                Nível 1</div>
                            <div class="staff-bio">Especializado em análise
                                de dados e desenvolvimento de novas
                                aplicações para a tecnologia K-Corp.</div>
                            <div class="staff-contact">Contato:
                                hanssen@kcorp.net | Ext: 3257</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Agendamento de Consultas - José
                        Lin</h3>
                    <p>Para agendar uma consulta com o José Lin, preencha o
                        formulário abaixo:</p>

                    <div class="form-group">
                        <label for="appointment-date">Data
                            Preferencial</label>
                        <input type="date" id="appointment-date"
                            class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="appointment-time">Horário
                            Preferencial</label>
                        <select id="appointment-time" class="form-control">
                            <option value>Selecione um horário</option>
                            <option value="08:00">08:00</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="appointment-reason">Motivo da
                            Consulta</label>
                        <textarea id="appointment-reason"
                            class="form-control"
                            placeholder="Descreva brevemente o motivo da consulta..."></textarea>
                    </div>
                    <button class="btn">Solicitar Agendamento</button>
                </div>
            </div>

            <!-- Página de Perfil -->
            <div id="profile" class="tab-content">
                <h2 class="page-title">Perfil do Usuário</h2>

                <div class="profile-header">
                    <div class="profile-avatar" id="profile-avatar-large">
                        <span id="profile-avatar-text">DL</span>
                        <img id="profile-avatar-img" src alt="Avatar"
                            style="display: none;">
                        <div class="profile-avatar-edit"
                            id="change-avatar-btn">Alterar</div>
                    </div>
                    <div class="profile-info">
                        <h2 id="profile-fullname">Dante L. Silva</h2>
                        <p id="profile-position">Pesquisador Nível 2</p>
                        <p id="profile-email">dante.silva@kcorp.net</p>
                        <p id="profile-department">Departamento de Pesquisa e
                            Desenvolvimento</p>

                        <div class="profile-stats">
                            <div class="stat">
                                <div class="stat-value"
                                    id="profile-posts">12</div>
                                <div class="stat-label">Publicações</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value"
                                    id="profile-projects">5</div>
                                <div class="stat-label">Projetos</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value"
                                    id="profile-years">2</div>
                                <div class="stat-label">Anos na K-Corp</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="profile-tabs">
                    <div class="profile-tab active" data-tab="info">Informações
                        Pessoais</div>
                    <div class="profile-tab" data-tab="security">Segurança</div>
                    <div class="profile-tab"
                        data-tab="preferences">Preferências</div>
                </div>

                <!-- Aba de Informações Pessoais -->
                <div id="profile-info" class="profile-tab-content active">
                    <div class="card">
                        <h3 class="card-title">Informações do Perfil</h3>

                        <form id="profile-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="profile-firstname">Nome</label>
                                    <input type="text" id="profile-firstname"
                                        class="form-control" value="Dante">
                                </div>
                                <div class="form-group">
                                    <label
                                        for="profile-lastname">Sobrenome</label>
                                    <input type="text" id="profile-lastname"
                                        class="form-control" value="L. Silva">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="profile-position">Cargo</label>
                                    <input type="text"
                                        id="profile-position-input"
                                        class="form-control"
                                        value="Pesquisador Nível 2">
                                </div>
                                <div class="form-group">
                                    <label for="profile-level">Nível</label>
                                    <select id="profile-level"
                                        class="form-control">
                                        <option value="1" selected>Nível
                                            1</option>
                                        <option value="2">Nível 2</option>
                                        <option value="3">Nível 3</option>
                                        <option value="4">Nível 4</option>
                                        <option value="5">Nível 5</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label
                                    for="profile-department-input">Departamento</label>
                                <select id="profile-department-input"
                                    class="form-control">
                                    <option value="Pesquisa e Desenvolvimento"
                                        selected>Pesquisa e
                                        Desenvolvimento</option>
                                    <option value="Produção em Massa">Produção
                                        em Massa</option>
                                    <option
                                        value="Segurança Corporativa">Segurança
                                        Corporativa</option>
                                    <option value="Relações Públicas">Relações
                                        Públicas</option>
                                    <option value="Operações de Campo">Operações
                                        de Campo</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="profile-email-input">E-mail
                                    Corporativo</label>
                                <input type="email" id="profile-email-input"
                                    class="form-control"
                                    value="dante.silva@kcorp.net">
                            </div>

                            <div class="form-group">
                                <label for="profile-phone">Telefone</label>
                                <input type="text" id="profile-phone"
                                    class="form-control"
                                    value="+55 (11) 98765-4321">
                            </div>

                            <div class="form-group">
                                <label for="profile-bio">Biografia</label>
                                <textarea id="profile-bio" class="form-control"
                                    rows="4">Especialista em bio-alquimia aplicada e desenvolvimento de protocolos de campo para o Remédio K. Atualmente trabalhando na otimização da eficácia em condições extremas.</textarea>
                            </div>

                            <button type="submit" class="btn">Salvar
                                Alterações</button>
                        </form>
                    </div>
                </div>

                <!-- Aba de Segurança -->
                <div id="profile-security" class="profile-tab-content">
                    <div class="card">
                        <h3 class="card-title">Alterar Senha</h3>

                        <form id="password-form">
                            <div class="form-group">
                                <label for="current-password">Senha
                                    Atual</label>
                                <input type="password" id="current-password"
                                    class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="new-password">Nova Senha</label>
                                <input type="password" id="new-password"
                                    class="form-control">
                                <small>A senha deve ter pelo menos 8 caracteres,
                                    incluindo letras maiúsculas, minúsculas,
                                    números e símbolos.</small>
                            </div>

                            <div class="form-group">
                                <label for="confirm-password">Confirmar Nova
                                    Senha</label>
                                <input type="password" id="confirm-password"
                                    class="form-control">
                            </div>

                            <button type="submit" class="btn">Alterar
                                Senha</button>
                        </form>
                    </div>

                    <div class="card">
                        <h3 class="card-title">Sessões Ativas</h3>
                        <p>Estas são as sessões ativas em sua conta. Revogue
                            qualquer sessão que não reconheça.</p>

                        <div class="session-list">
                            <div class="session-item">
                                <div class="session-info">
                                    <strong>Portal K-Corp (Este
                                        dispositivo)</strong>
                                    <p>Última atividade: Hoje, 14:30</p>
                                    <p>IP: 192.168.1.105 • Localização: São
                                        Paulo, BR</p>
                                </div>
                                <div class="session-actions">
                                    <button class="btn btn-secondary"
                                        disabled>Atual</button>
                                </div>
                            </div>

                            <div class="session-item">
                                <div class="session-info">
                                    <strong>Dispositivo Móvel</strong>
                                    <p>Última atividade: Ontem, 09:15</p>
                                    <p>IP: 177.35.208.74 • Localização: Rio de
                                        Janeiro, BR</p>
                                </div>
                                <div class="session-actions">
                                    <button
                                        class="btn btn-secondary">Revogar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Aba de Preferências -->
                <div id="profile-preferences" class="profile-tab-content">
                    <div class="card">
                        <h3 class="card-title">Preferências de Notificação</h3>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked> Notificações por
                                e-mail
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked> Notificações de
                                novas publicações
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox"> Notificações de
                                comentários
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" checked> Alertas de
                                segurança
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox"> Notificações de projetos
                            </label>
                        </div>

                        <button class="btn">Salvar Preferências</button>
                    </div>

                    <div class="card">
                        <h3 class="card-title">Preferências de Interface</h3>

                        <div class="form-group">
                            <label for="theme-select">Tema</label>
                            <select id="theme-select" class="form-control">
                                <option value="dark" selected>Escuro
                                    (Padrão)</option>
                                <option value="light">Claro</option>
                                <option value="auto">Automático (Segue o
                                    sistema)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="language-select">Idioma</label>
                            <select id="language-select" class="form-control">
                                <option value="pt-BR" selected>Português
                                    (Brasil)</option>
                                <option value="en-US">English (US)</option>
                                <option value="es-ES">Español</option>
                            </select>
                        </div>

                        <button class="btn">Salvar Preferências</button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Modal para alterar avatar -->
        <div class="modal" id="avatar-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Alterar Foto de Perfil</h3>
                    <button class="modal-close"
                        id="close-avatar-modal">&times;</button>
                </div>

                <div class="modal-body">
                    <div class="form-group">
                        <label>Selecionar uma foto pré-definida:</label>
                        <div class="avatar-options">
                            <div class="avatar-option"
                                data-avatar="avatar1.jpg">
                                <img
                                    src="https://tse2.mm.bing.net/th/id/OIP.DYlkcl6rnRLEd669hbQ-ggHaGh?rs=1&pid=ImgDetMain&o=7&rm=3"
                                    alt="Avatar 1">
                            </div>
                            <div class="avatar-option"
                                data-avatar="avatar2.jpg">
                                <img
                                    src="https://tse1.mm.bing.net/th/id/OIP.Zh_BIaR9c7O8ENfHaktUbgHaGh?rs=1&pid=ImgDetMain&o=7&rm=3"
                                    alt="Avatar 2">
                            </div>
                            <div class="avatar-option"
                                data-avatar="avatar3.jpg">
                                <img
                                    src="https://tse2.mm.bing.net/th/id/OIP.3-Ofkn4m1CNFN_Gu-sw1zgHaGh?rs=1&pid=ImgDetMain&o=7&rm=3"
                                    alt="Avatar 3">
                            </div>
                            <div class="avatar-option"
                                data-avatar="avatar4.jpg">
                                <img
                                    src="https://tse4.mm.bing.net/th/id/OIP.xC4kVDKlnIhIELclYrti-AAAAA?rs=1&pid=ImgDetMain&o=7&rm=3"
                                    alt="Avatar 4">
                            </div>
                             </div>
                            <div class="avatar-option"
                                data-avatar="avatar5.jpg">
                                <img
                                    src="https://th.bing.com/th/id/OIP.UKwYft4_qREOZ_Yv1L2MIAAAAA?o=7rm=3&rs=1&pid=ImgDetMain&o=7&rm=3"
                                    alt="Avatar 5">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Ou fazer upload de uma imagem:</label>
                        <input type="file" id="avatar-upload"
                            class="form-control" accept="image/*">
                    </div>

                    <div class="form-group">
                        <label>Ou usar as iniciais do nome:</label>
                        <button class="btn btn-secondary"
                            id="use-initials-btn">Usar Iniciais</button>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary"
                        id="cancel-avatar-btn">Cancelar</button>
                    <button class="btn" id="save-avatar-btn">Salvar</button>
                </div>
            </div>
        </div>

        <footer>
            <div class="container">
                <div class="footer-links">
                    <a href="#">Política de Segurança</a>
                    <a href="#">Termos de Uso</a>
                    <a href="#">Suporte Técnico</a>
                    <a href="#">Documentação</a>
                </div>
                <p>K-Corp Internal Network v3.4.1 | Acesso restrito a
                    funcionários autorizados</p>
                <p>Todo o conteúdo é propriedade da Corporação do Cálice e está
                    sujeito às leis de sigilo corporativo.</p>
            </div>
        </footer>

        <script>
        // Sistema de carregamento do usuário
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar se o usuário está logado
            const currentUser = localStorage.getItem('kcorp_current_user');
            
            if (!currentUser) {
                window.location.href = 'Login-K.html';
            } else {
                // Atualiza a interface com informações do usuário
                try {
                    const user = JSON.parse(currentUser);
                    updateUserInterface(user);
                } catch (error) {
                    console.error('Erro ao carregar dados do usuário:', error);
                    window.location.href = 'Login-K.html';
                }
            }
            
            // Navegação entre abas
            const navLinks = document.querySelectorAll('.nav-link');
            const tabContents = document.querySelectorAll('.tab-content');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove classe active de todos os links e conteúdos
                    navLinks.forEach(l => l.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Adiciona classe active ao link clicado
                    this.classList.add('active');
                    
                    // Mostra o conteúdo correspondente
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Navegação entre abas do perfil
            const profileTabs = document.querySelectorAll('.profile-tab');
            const profileTabContents = document.querySelectorAll('.profile-tab-content');
            
            profileTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove classe active de todas as abas e conteúdos
                    profileTabs.forEach(t => t.classList.remove('active'));
                    profileTabContents.forEach(content => content.classList.remove('active'));
                    
                    // Adiciona classe active à aba clicada
                    this.classList.add('active');
                    
                    // Mostra o conteúdo correspondente
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`profile-${tabId}`).classList.add('active');
                });
            });
            
            // Formulário de perfil
            const profileForm = document.getElementById('profile-form');
            if (profileForm) {
                profileForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Coletar dados do formulário
                    const userData = {
                        firstname: document.getElementById('profile-firstname').value,
                        lastname: document.getElementById('profile-lastname').value,
                        position: document.getElementById('profile-position-input').value,
                        level: document.getElementById('profile-level').value,
                        department: document.getElementById('profile-department-input').value,
                        email: document.getElementById('profile-email-input').value,
                        phone: document.getElementById('profile-phone').value,
                        bio: document.getElementById('profile-bio').value
                    };
                    
                    // Atualizar dados do usuário
                    updateUserProfile(userData);
                    
                    // Mostrar mensagem de sucesso
                    showMessage('Perfil atualizado com sucesso!', 'success');
                });
            }
            
            // Formulário de senha
            const passwordForm = document.getElementById('password-form');
            if (passwordForm) {
                passwordForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const currentPassword = document.getElementById('current-password').value;
                    const newPassword = document.getElementById('new-password').value;
                    const confirmPassword = document.getElementById('confirm-password').value;
                    
                    // Validações básicas
                    if (!currentPassword) {
                        showMessage('Por favor, insira sua senha atual.', 'error');
                        return;
                    }
                    
                    if (newPassword.length < 8) {
                        showMessage('A nova senha deve ter pelo menos 8 caracteres.', 'error');
                        return;
                    }
                    
                    if (newPassword !== confirmPassword) {
                        showMessage('As senhas não coincidem.', 'error');
                        return;
                    }
                    
                    // Em um sistema real, aqui enviaríamos os dados para o servidor
                    // Por enquanto, apenas simulamos a alteração
                    
                    // Limpar formulário
                    passwordForm.reset();
                    
                    // Mostrar mensagem de sucesso
                    showMessage('Senha alterada com sucesso!', 'success');
                });
            }
            
            // Modal de avatar
            const avatarModal = document.getElementById('avatar-modal');
            const changeAvatarBtn = document.getElementById('change-avatar-btn');
            const closeAvatarModal = document.getElementById('close-avatar-modal');
            const cancelAvatarBtn = document.getElementById('cancel-avatar-btn');
            const saveAvatarBtn = document.getElementById('save-avatar-btn');
            const useInitialsBtn = document.getElementById('use-initials-btn');
            const avatarOptions = document.querySelectorAll('.avatar-option');
            
            // Abrir modal
            changeAvatarBtn.addEventListener('click', function() {
                avatarModal.classList.add('active');
            });
            
            // Fechar modal
            function closeAvatarModalFunc() {
                avatarModal.classList.remove('active');
            }
            
            closeAvatarModal.addEventListener('click', closeAvatarModalFunc);
            cancelAvatarBtn.addEventListener('click', closeAvatarModalFunc);
            
            // Selecionar avatar pré-definido
            avatarOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove seleção de todos
                    avatarOptions.forEach(opt => opt.classList.remove('selected'));
                    // Adiciona seleção ao clicado
                    this.classList.add('selected');
                });
            });
            
            // Usar iniciais
            useInitialsBtn.addEventListener('click', function() {
                const user = JSON.parse(localStorage.getItem('kcorp_current_user'));
                const initials = user.fullname.split(' ').map(n => n[0]).join('');
                
                // Atualizar avatar
                updateUserAvatar(null, initials);
                
                // Fechar modal
                closeAvatarModalFunc();
                
                // Mostrar mensagem
                showMessage('Avatar atualizado para iniciais!', 'success');
            });
            
            // Salvar avatar
            saveAvatarBtn.addEventListener('click', function() {
                const selectedOption = document.querySelector('.avatar-option.selected');
                
                if (selectedOption) {
                    // ✅ CORREÇÃO: Pegar a URL da imagem, não do data-attribute
                    const avatarUrl = selectedOption.querySelector('img').src;
                    updateUserAvatar(avatarUrl);
                    
                    // Fechar modal
                    closeAvatarModalFunc();
                    
                    // Mostrar mensagem
                    showMessage('Avatar atualizado com sucesso!', 'success');
                } else {
                    showMessage('Por favor, selecione uma opção de avatar.', 'error');
                }
            });
            
            // Upload de imagem
            const avatarUpload = document.getElementById('avatar-upload');
            avatarUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        // Em um sistema real, enviaríamos o arquivo para o servidor
                        // Por enquanto, apenas usamos a URL local
                        updateUserAvatar(event.target.result);
                        
                        // Fechar modal
                        closeAvatarModalFunc();
                        
                        // Mostrar mensagem
                        showMessage('Avatar atualizado com sucesso!', 'success');
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Botão de perfil no header
            const userProfileBtn = document.getElementById('user-profile-btn');
            userProfileBtn.addEventListener('click', function() {
                // Navegar para a aba de perfil
                navLinks.forEach(l => l.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));
                
                document.querySelector('.nav-link[data-tab="profile"]').classList.add('active');
                document.getElementById('profile').classList.add('active');
            });
            
            // Função para atualizar a interface do usuário
            function updateUserInterface(user) {
                // Atualiza o header
                document.getElementById('user-name').textContent = user.fullname;
                document.getElementById('user-role').textContent = user.position;
                
                // Atualiza o avatar no header
                const userAvatar = document.getElementById('user-avatar');
                if (user.avatar && user.avatarType === 'image') {
                    userAvatar.style.backgroundImage = `url(${user.avatar})`;
                    userAvatar.style.backgroundSize = 'cover';
                    userAvatar.style.backgroundPosition = 'center';
                    userAvatar.textContent = '';
                } else {
                    userAvatar.style.backgroundImage = '';
                    const initials = user.fullname.split(' ').map(n => n[0]).join('');
                    userAvatar.textContent = initials;
                }
                
                // Atualiza a página de perfil
                document.getElementById('profile-fullname').textContent = user.fullname;
                document.getElementById('profile-position').textContent = user.position;
                document.getElementById('profile-email').textContent = user.email;
                document.getElementById('profile-department').textContent = user.department;
                
                // Atualiza o avatar do perfil
                const profileAvatarText = document.getElementById('profile-avatar-text');
                const profileAvatarImg = document.getElementById('profile-avatar-img');
                
                if (user.avatar && user.avatarType === 'image') {
                    profileAvatarText.style.display = 'none';
                    profileAvatarImg.src = user.avatar;
                    profileAvatarImg.style.display = 'block';
                } else {
                    const initials = user.fullname.split(' ').map(n => n[0]).join('');
                    profileAvatarText.textContent = initials;
                    profileAvatarText.style.display = 'block';
                    profileAvatarImg.style.display = 'none';
                }
                
                // Preenche o formulário de perfil
                document.getElementById('profile-firstname').value = user.firstname || user.fullname.split(' ')[0];
                document.getElementById('profile-lastname').value = user.lastname || user.fullname.split(' ').slice(1).join(' ');
                document.getElementById('profile-position-input').value = user.position;
                document.getElementById('profile-level').value = user.level || '1';
                document.getElementById('profile-department-input').value = user.department;
                document.getElementById('profile-email-input').value = user.email;
                document.getElementById('profile-phone').value = user.phone || '';
                document.getElementById('profile-bio').value = user.bio || '';
                
                // Atualiza estatísticas
                document.getElementById('profile-posts').textContent = user.posts || '0';
                document.getElementById('profile-projects').textContent = user.projects || '0';
                document.getElementById('profile-years').textContent = user.years || '1';
            }
            
            // Função para atualizar o perfil do usuário
            function updateUserProfile(userData) {
                // Obter usuário atual
                const currentUser = JSON.parse(localStorage.getItem('kcorp_current_user'));
                
                // Atualizar dados
                currentUser.firstname = userData.firstname;
                currentUser.lastname = userData.lastname;
                currentUser.fullname = `${userData.firstname} ${userData.lastname}`;
                currentUser.position = userData.position;
                currentUser.level = userData.level;
                currentUser.department = userData.department;
                currentUser.email = userData.email;
                currentUser.phone = userData.phone;
                currentUser.bio = userData.bio;
                
                // Salvar no localStorage
                localStorage.setItem('kcorp_current_user', JSON.stringify(currentUser));
                
                // Atualizar interface
                updateUserInterface(currentUser);
            }
            
            // Função para atualizar o avatar do usuário
            function updateUserAvatar(avatarUrl, initials = null) {
                // Obter usuário atual
                const currentUser = JSON.parse(localStorage.getItem('kcorp_current_user'));
                
                // Atualizar avatar
                if (avatarUrl) {
                    currentUser.avatar = avatarUrl;
                    currentUser.avatarType = 'image';
                } else if (initials) {
                    currentUser.avatar = null;
                    currentUser.avatarType = 'initials';
                }
                
                // Salvar no localStorage
                localStorage.setItem('kcorp_current_user', JSON.stringify(currentUser));
                
                // Atualizar interface
                updateUserInterface(currentUser);
            }
            
            // Função para mostrar mensagens
            function showMessage(message, type) {
                // Criar elemento de mensagem
                const messageEl = document.createElement('div');
                messageEl.className = `message ${type}`;
                messageEl.textContent = message;
                
                // Adicionar ao início do conteúdo principal
                const mainContent = document.querySelector('main .container');
                mainContent.insertBefore(messageEl, mainContent.firstChild);
                
                // Remover após 5 segundos
                setTimeout(() => {
                    messageEl.remove();
                }, 5000);
            }
            
            function initializeUserData() {
    let currentUser = localStorage.getItem('kcorp_current_user');

    if (currentUser) {
        const user = JSON.parse(currentUser);
        
        // Verificar se é a PRIMEIRA vez que o usuário está logando
        // Se o usuário já tem dados personalizados (firstname, avatar customizado), NÃO resetar
        const isFirstTimeUser = !user.firstname || 
                               (user.email === 'gm@kcorp.net' && !user.avatar && user.avatarType === 'initials') ||
                               (user.email === 'jl@kcorp.net' && !user.avatar && user.avatarType === 'initials') ||
                               (user.email === 'kuuhaku@kcorp.net' && !user.avatar && user.avatarType === 'initials') ||
                               (user.email === 'scar@kcorp.net' && !user.avatar && user.avatarType === 'initials') ||
                               (user.email === 'hanssen@kcorp.net' && !user.avatar && user.avatarType === 'initials');

        if (isFirstTimeUser) {
            // Apenas na PRIMEIRA vez: inicializar dados padrão
            let userData = {};
            
            switch(user.email) {
                case 'gm@kcorp.net':
                    userData = {
                        firstname: "Game",
                        lastname: "Master",
                        fullname: "Game Master",
                        position: "Administrador do Sistema",
                        level: "5",
                        department: "admin",
                        phone: "+55 (11) 99999-9999",
                        bio: "Administrador do sistema K-Corp com acesso total à rede corporativa.",
                        posts: "12",
                        projects: "5",
                        years: "2",
                        avatar: null,
                        avatarType: "initials"
                    };
                    break;
                    
                case 'jl@kcorp.net':
                    userData = {
                        firstname: "José",
                        lastname: "Lin",
                        fullname: "José Lin",
                        position: "Médico de Campo Sênior | Pesquisador Nível 1",
                        level: "1",
                        department: "research",
                        phone: "+55 (11) 98765-4321",
                        bio: "Especialista em aplicação de campo do Remédio K e desenvolvimento de protocolos de emergência.",
                        posts: "8",
                        projects: "3",
                        years: "1",
                        avatar: null,
                        avatarType: "initials"
                    };
                    break;
                    
                case 'kuuhaku@kcorp.net':
                    userData = {
                        firstname: "Kuuhaku",
                        lastname: "",
                        fullname: "Kuuhaku",
                        position: "Agente de Campo Especial | Nível 1",
                        level: "1",
                        department: "field",
                        phone: "+55 (11) 98765-4322",
                        bio: "Especialista em operações táticas e reconhecimento em zonas de conflito.",
                        posts: "5",
                        projects: "2",
                        years: "1",
                        avatar: null,
                        avatarType: "initials"
                    };
                    break;
                    
                case 'scar@kcorp.net':
                    userData = {
                        firstname: "Scar",
                        lastname: "",
                        fullname: "Scar",
                        position: "Especialista em Segurança | Nível 1",
                        level: "1",
                        department: "field",
                        phone: "+55 (11) 98765-4323",
                        bio: "Responsável pela segurança de instalações críticas e proteção de pessoal.",
                        posts: "3",
                        projects: "4",
                        years: "1",
                        avatar: null,
                        avatarType: "initials"
                    };
                    break;
                    
                case 'hanssen@kcorp.net':
                    userData = {
                        firstname: "Hanssen",
                        lastname: "",
                        fullname: "Hanssen",
                        position: "Pesquisador Sênior | Nível 1",
                        level: "1",
                        department: "field",
                        phone: "+55 (11) 98765-4324",
                        bio: "Especializado em análise de dados e desenvolvimento de novas aplicações.",
                        posts: "10",
                        projects: "6",
                        years: "2",
                        avatar: null,
                        avatarType: "initials"
                    };
                    break;
                    
                default:
                    userData = {
                        firstname: user.fullname.split(' ')[0],
                        lastname: user.fullname.split(' ').slice(1).join(' '),
                        fullname: user.fullname,
                        position: user.position,
                        level: "1",
                        department: user.department,
                        phone: "+55 (11) 99999-9999",
                        bio: "Funcionário da K-Corp.",
                        posts: "0",
                        projects: "0",
                        years: "1",
                        avatar: null,
                        avatarType: "initials"
                    };
            }
            
            // Mesclar dados existentes com dados padrão (PRESERVANDO avatar se existir)
            const mergedUser = { 
                ...userData, 
                ...user, // Dados do login têm prioridade para username, password, etc.
                avatar: user.avatar || userData.avatar, // Preservar avatar se já existir
                avatarType: user.avatarType || userData.avatarType // Preservar tipo de avatar
            };
            
            localStorage.setItem('kcorp_current_user', JSON.stringify(mergedUser));
            currentUser = localStorage.getItem('kcorp_current_user');
        }
        
        // Garantir que todos os campos existam (SEM sobrescrever avatar)
        const finalUser = JSON.parse(currentUser);
        if (!finalUser.firstname) finalUser.firstname = finalUser.fullname.split(' ')[0];
        if (!finalUser.lastname) finalUser.lastname = finalUser.fullname.split(' ').slice(1).join(' ');
        if (!finalUser.level) finalUser.level = '1';
        if (!finalUser.phone) finalUser.phone = '+55 (11) 99999-9999';
        if (!finalUser.bio) finalUser.bio = 'Funcionário da K-Corp.';
        if (!finalUser.posts) finalUser.posts = '0';
        if (!finalUser.projects) finalUser.projects = '0';
        if (!finalUser.years) finalUser.years = '1';
        if (!finalUser.avatarType) finalUser.avatarType = 'initials';
        
        // NUNCA resetar avatar se já existe um
        // if (!finalUser.avatar) finalUser.avatar = null; // REMOVER ESTA LINHA
        
        localStorage.setItem('kcorp_current_user', JSON.stringify(finalUser));
        
        // Atualizar interface com dados corretos
        updateUserInterface(finalUser);
    }
}
                
            // Executar inicialização
            initializeUserData();
        });
    </script>
    </body>
</html>